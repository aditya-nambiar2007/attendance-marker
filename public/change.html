<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>ConnectUp</title>
    <style>
      /* General Body Styling */
      body {
        font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
          Helvetica, Arial, sans-serif;
        background-color: #f4f7f6;
        margin: 0;
        padding: 0;
        min-height: 100vh;
      }

      /* Navbar Styling */
      .navbar {
        background-color: #ffffff;
        padding: 0 40px;
        box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
        display: flex;
        justify-content: space-between;
        align-items: center;
        height: 60px;
      }

      .navbar .brand {
        font-size: 24px;
        font-weight: 600;
        color: #007bff;
      }

      .navbar .nav-links a {
        color: #555;
        text-decoration: none;
        font-size: 16px;
        margin-left: 20px;
        padding: 8px 12px;
        border-radius: 6px;
        transition: background-color 0.3s, color 0.3s;
      }

      .navbar .nav-links a:hover {
        background-color: #f0f0f0;
      }

      .navbar .nav-links a.active {
        background-color: #007bff;
        color: white;
        font-weight: 500;
      }

      /* Main content container to center the forms */
      .main-container {
        display: flex;
        justify-content: center;
        align-items: center;
        padding: 40px 20px;
      }

      /* Form Container */
      .form-container {
        background-color: #ffffff;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 8px 16px rgba(0, 0, 0, 0.1);
        width: 100%;
        max-width: 500px;
      }

      /* Form Header */
      h2 {
        text-align: center;
        color: #333;
        margin-top: 0;
        margin-bottom: 25px;
      }

      /* Toggle Switch for Role Selection in Registration */
      .role-selector {
        display: flex;
        justify-content: center;
        margin-bottom: 30px;
        border: 1px solid #ddd;
        border-radius: 25px;
        overflow: hidden;
      }

      .role-selector label {
        flex: 1;
        text-align: center;
        padding: 12px 0;
        cursor: pointer;
        transition: background-color 0.3s, color 0.3s;
        color: #555;
      }

      .role-selector input[type="radio"] {
        display: none; /* Hide the actual radio buttons */
      }

      .role-selector input[type="radio"]:checked + label {
        background-color: #007bff;
        color: white;
        font-weight: 600;
      }

      /* Form Groups for consistent spacing */
      .form-group {
        margin-bottom: 20px;
        position: relative;
      }

      .form-group label {
        display: block;
        margin-bottom: 8px;
        font-weight: 500;
        color: #555;
      }

      .form-group input,
      .form-group select {
        width: 100%;
        padding: 12px;
        border: 1px solid #ccc;
        border-radius: 6px;
        box-sizing: border-box; /* Important for padding and width */
        transition: border-color 0.3s;
      }

      .form-group input:focus,
      .form-group select:focus {
        outline: none;
        border-color: #007bff;
        box-shadow: 0 0 5px rgba(0, 123, 255, 0.25);
      }

      /* Submit Button */
      button[type="submit"] {
        width: 100%;
        padding: 14px;
        color: white;
        border: none;
        border-radius: 6px;
        font-size: 16px;
        font-weight: 600;
        cursor: pointer;
        transition: background-color 0.3s;
      }

      #loginForm button[type="submit"] {
        background-color: #007bff;
      }
      #loginForm button[type="submit"]:hover {
        background-color: #0056b3;
      }

      #registrationForm button[type="submit"] {
        background-color: #28a745;
      }

      #registrationForm button[type="submit"]:hover {
        background-color: #218838;
      }

      /* small preview styling */
      .pfp-preview {
        display: block;
        margin-top: 8px;
        border-radius: 6px;
        border: 1px solid #ddd;
      }

      .file-label {
        display: inline-block;
        padding: 8px 12px;
        border-radius: 6px;
        background: #f8f9fa;
        cursor: pointer;
        border: 1px solid #ccc;
      }

      .hidden {
        display: none;
      }

      /* Custom Modal Prompt Styling */
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: rgba(0, 0, 0, 0.6);
        display: flex;
        justify-content: center;
        align-items: center;
        z-index: 1000;
      }

      .modal-content {
        background: white;
        padding: 30px 40px;
        border-radius: 12px;
        box-shadow: 0 5px 15px rgba(0,0,0,0.3);
        width: 100%;
        max-width: 400px;
        text-align: center;
      }

      .modal-content h2 {
        margin-top: 0;
        margin-bottom: 10px;
      }

      .modal-content p {
        margin-bottom: 20px;
        color: #666;
      }
      .modal-content .form-group {
        text-align: left;
      }
    </style>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.7.1/jquery.min.js"></script>
  </head>
  <body>
    <nav class="navbar">
      <div class="brand"  onclick="location.href='/home.html'">ConnectUp</div>
    </nav>

    <!-- Custom Verification Modal -->
    <div id="verify-modal" class="modal-overlay">
      <div class="modal-content">
        <h2>Verify Your Identity</h2>
        <p>Please enter your credentials to make changes.</p>
        <form id="verify-form">
          <div class="form-group">
            <label for="verify-email">Email Address</label>
            <input type="email" id="verify-email" name="email" required />
          </div>
          <div class="form-group">
            <label for="verify-password">Password</label>
            <input type="password" id="verify-password" name="password" required />
          </div>
          <button type="submit">Verify</button>
        </form>
      </div>
    </div>

    <div class="main-container">
      <!-- Registration Form Container -->
      <div class="form-container" id="registration-container">
        <h2>Change Account Details</h2>
        <form id="registrationForm" action="/change" method="POST">
          <!-- Hidden input to specify the user role as 'student' -->
          <input type="hidden" name="userRole" value="student" />

          <div class="form-group">
            <label for="reg-fullName">Full Name</label>
            <input type="text" id="reg-fullName" name="fullName" required />
          </div>
          <div class="form-group">
            <label for="reg-email">Email Address</label>
            <input type="email" id="reg-email" name="email" required />
          </div>
          <div class="form-group">
            <label for="reg-password">Password</label>
            <input type="password" id="reg-password" name="password" placeholder="Leave blank to keep current password" />
          </div>

          <!-- Student-only fields -->
          <div id="student-fields">
            <div class="form-group">
              <label for="reg-branch">Branch</label>
              <select id="reg-branch" name="branch" required>
                <option value="">--Select Branch--</option>
                <option value="CSE">Computer Science & Engineering</option>
                <option value="EE">Electrical Engineering</option>
                <option value="ME">Mechanical Engineering</option>
                <option value="CE">Civil Engineering</option>
                <option value="CB">Chemical Engineering</option>
              </select>
            </div>
            <div class="form-group">
              <label for="reg-year">Year</label>
              <select id="reg-year" name="year" required>
                <option value="">--Select Year--</option>
                <option value="1">1st Year</option>
                <option value="2">2nd Year</option>
                <option value="3">3rd Year</option>
                <option value="4">4th Year</option>
              </select>
            </div>
          </div>



          <div class="form-group">
            <label for="reg-bio">Bio</label>
            <textarea id="reg-bio" name="Bio" rows="3" placeholder="Tell us a little about yourself..."></textarea>
          </div>

          <button type="submit">Register</button>
        </form>
      </div>


    <script>
      $(document).ready(function() {
        // The main form is hidden until verification is complete
        $('.main-container').hide();

        $('#verify-form').on('submit', function(e) {
          e.preventDefault();
          const email = $('#verify-email').val();
          const password = $('#verify-password').val();

          $.post("/verify", { email: email, password: password }, function(data) {
            if (data.status === "success") {
                $('#reg-fullName').val(data.data.name);
                $('#reg-email').val(data.data.email);
                $('#reg-branch').val(data.data.branch);
                $('#reg-year').val(data.data.year);
                $('#reg-bio').val(data.data.Bio);
              $('#verify-modal').hide(); // Hide the modal
              $('.main-container').show(); // Show the main form
            } else {
              alert("Invalid credentials! Redirecting to login page.");
              window.location.href = "/register#login";
            }
          });
        });
      });

    </script>
  </body>
</html>